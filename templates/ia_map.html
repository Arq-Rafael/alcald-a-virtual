{% extends "base.html" %}

{% block head %}
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
{% endblock %}

{% block content %}
<div class="container my-5">
  <h1 class="mb-4">Mapas Inteligentes</h1>
  <div id="map" style="height: 500px; border: 1px solid #ccc;"></div>
  <a href="{{ url_for('ia') }}" class="btn btn-link mt-3">← Volver a IA Municipal</a>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Inicializamos Leaflet
  const map = L.map('map').setView([4.7, -74.1], 10);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
  }).addTo(map);

  // Cargamos tu GeoJSON del backend
  fetch('{{ url_for("ia_map_data") }}')
    .then(r => r.json())
    .then(geojson => {
      L.geoJSON(geojson, {
        style: feature => ({ color: feature.properties.color || '#3388ff' })
      }).addTo(map);
    })
    .catch(err => console.error('Error cargando GeoJSON:', err));
</script>
{% endblock %}
